<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Catch the Falling Stars</title>
  <style>
    body {
      margin: 0;
      background: #000;
      overflow: hidden;
      font-family: sans-serif;
      color: white;
    }
    #gameCanvas {
      display: block;
      margin: 0 auto;
      background: linear-gradient(to top, #001, #112);
      border: 2px solid white;
    }
    #scoreBoard {
      text-align: center;
      font-size: 20px;
      margin-top: 10px;
      display: none;
    }
    #startScreen, #instructionsPanel, #leaderboard {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.8);
      padding: 20px;
      border: 2px solid white;
      border-radius: 10px;
      text-align: center;
      font-size: 18px;
      max-width: 400px;
    }
    #startScreen {
      top: 40%;
      font-size: 24px;
    }
    #instructionsPanel {
      top: 20%;
      display: none;
    }
    #leaderboard {
      top: 60%;
      display: none;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>

<canvas id="gameCanvas" width="600" height="400"></canvas>
<div id="scoreBoard">Score: 0 | Missed: 0</div>
<div id="startScreen">Press <strong>Enter</strong> to Start</div>
<div id="instructionsPanel">
  <h3>Instructions</h3>
  <p>Use ‚Üê and ‚Üí arrow keys to move the basket.</p>
  <p>Catch falling stars to earn points.</p>
  <p>Golden Star ‚≠ê = +5 points</p>
  <p>Shield üõ°Ô∏è = Removes 1 miss</p>
  <p>Slow Time üïí = Slows stars for 5 seconds</p>
  <p>Game ends after 100 missed stars.</p>
  <p>Press <strong>Enter</strong> to begin.</p>
</div>
<div id="leaderboard">
  <h3>High Scores</h3>
  <ol id="highScoresList"></ol>
</div>

<script>
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");
  const scoreBoard = document.getElementById("scoreBoard");
  const startScreen = document.getElementById("startScreen");
  const instructionsPanel = document.getElementById("instructionsPanel");
  const leaderboard = document.getElementById("leaderboard");
  const highScoresList = document.getElementById("highScoresList");

  const basket = {
    x: canvas.width / 2 - 50,
    y: canvas.height - 30,
    width: 100,
    height: 20,
    speed: 5
  };

  const stars = [];
  let score = 0;
  let missed = 0;
  let gameOver = false;
  let slowTimeActive = false;
  let gameStarted = false;

  let keys = {
    left: false,
    right: false
  };

  function drawBasket() {
    ctx.fillStyle = "#0f0";
    ctx.fillRect(basket.x, basket.y, basket.width, basket.height);
  }

  function drawStar(star) {
    ctx.beginPath();
    ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);

    if (star.type === "gold") ctx.fillStyle = "#FFD700";
    else if (star.type === "shield") ctx.fillStyle = "#00f";
    else if (star.type === "slow") ctx.fillStyle = "#a0f";
    else ctx.fillStyle = "#ff0";

    ctx.fill();
    ctx.closePath();
  }

  function spawnStar() {
    const x = Math.random() * canvas.width;
    const typeChance = Math.random();
    let type = "normal";

    if (typeChance < 0.05) type = "gold";
    else if (typeChance < 0.10) type = "shield";
    else if (typeChance < 0.15) type = "slow";

    stars.push({ x, y: 0, radius: 8, speed: 2 + Math.random() * 2, type });
  }

  function updateStars() {
    for (let i = stars.length - 1; i >= 0; i--) {
      const star = stars[i];
      star.y += star.speed;

      if (
        star.y + star.radius >= basket.y &&
        star.x >= basket.x &&
        star.x <= basket.x + basket.width
      ) {
        if (star.type === "gold") score += 5;
        else if (star.type === "shield") missed = Math.max(0, missed - 1);
        else if (star.type === "slow") activateSlowTime();
        else score++;

        stars.splice(i, 1);
      } else if (star.y > canvas.height) {
        stars.splice(i, 1);
        missed++;
        if (missed >= 100) {
          gameOver = true;
          updateLeaderboard(score);
          showLeaderboard();
        }
      }
    }
  }

  function activateSlowTime() {
    if (slowTimeActive) return;
    slowTimeActive = true;
    stars.forEach(s => s.speed *= 0.5);
    setTimeout(() => {
      stars.forEach(s => s.speed *= 2);
      slowTimeActive = false;
    }, 5000);
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawBasket();
    stars.forEach(drawStar);
  }

  function updateScoreBoard() {
    scoreBoard.textContent = `Score: ${score} | Missed: ${missed}`;
  }

  function gameLoop() {
    if (!gameStarted) return;

    if (!gameOver) {
      if (Math.random() < 0.03) spawnStar();
      updateStars();

      if (keys.left) basket.x -= basket.speed;
      if (keys.right) basket.x += basket.speed;
      basket.x = Math.max(0, Math.min(canvas.width - basket.width, basket.x));

      draw();
      updateScoreBoard();
      requestAnimationFrame(gameLoop);
    } else {
      ctx.fillStyle = "red";
      ctx.font = "30px sans-serif";
      ctx.fillText("Game Over!", canvas.width / 2 - 80, canvas.height / 2);
    }
  }

  function updateLeaderboard(newScore) {
    let scores = JSON.parse(localStorage.getItem("highScores")) || [];
    scores.push(newScore);
    scores.sort((a, b) => b - a);
    scores = scores.slice(0, 5);
    localStorage.setItem("highScores", JSON.stringify(scores));
  }

  function showLeaderboard() {
    const scores = JSON.parse(localStorage.getItem("highScores")) || [];
    highScoresList.innerHTML = "";
    scores.forEach(score => {
      const li = document.createElement("li");
      li.textContent = score;
      highScoresList.appendChild(li);
    });
    leaderboard.style.display = "block";
  }

  document.addEventListener("keydown", function(e) {
    if (!gameStarted && (e.key === "Enter" || e.code === "Enter")) {
      gameStarted = true;
      startScreen.style.display = "none";
      instructionsPanel.style.display = "none";
      scoreBoard.style.display = "block";
      leaderboard.style.display = "none";
      score = 0;
      missed = 0;
      gameOver = false;
      stars.length = 0;
      gameLoop();
      return;
    }

    if (gameStarted) {
      if (e.key === "ArrowLeft") keys.left = true;
      if (e.key === "ArrowRight") keys.right = true;
    }
  });

  document.addEventListener("keyup", function(e) {
    if (e.key === "ArrowLeft") keys.left = false;
    if (e.key === "ArrowRight") keys.right = false;
  });

  // Show instructions on load
  window.addEventListener("load", () => {
    instructionsPanel.style.display = "block";
  });
</script>

</body>
</html>
